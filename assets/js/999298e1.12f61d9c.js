"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[605],{7611:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var i=t(4848),r=t(8453);const s={title:"Logging Guidelines",sidebar_position:6},o=void 0,l={id:"logging-guidelines",title:"Logging Guidelines",description:"[//]: # (Copyright Jiaqi Liu)",source:"@site/docs/logging-guidelines.md",sourceDirName:".",slug:"/logging-guidelines",permalink:"/athena/docs/logging-guidelines",draft:!1,unlisted:!1,editUrl:"https://github.com/QubitPi/athena/tree/master/docs/docs/logging-guidelines.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Logging Guidelines",sidebar_position:6},sidebar:"docSidebar",previous:{title:"Monitoring and Operations",permalink:"/athena/docs/monitoring-and-operations"},next:{title:"Key Performance Indicators - Athena Web Service",permalink:"/athena/docs/kpi"}},a={},d=[{value:"Summary",id:"summary",level:2},{value:"Log Levels",id:"log-levels",level:2},{value:"Error",id:"error",level:3},{value:"Warn",id:"warn",level:3},{value:"Info",id:"info",level:3},{value:"Debug",id:"debug",level:3},{value:"Trace",id:"trace",level:3}];function h(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Logs are an important tool for debugging problems, as well as for gaining insight into how something is running under\notherwise normal conditions. Because logs are so useful, it's tempting to always log everything that's going on, but\nprocessing logs is much more work than it would seem and writing too many logs has a significant negative impact on\nperformance."}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"Details and examples are below, but here's a summary of the log levels and their meanings."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Level"}),(0,i.jsx)(n.th,{children:"Meaning"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Error"}),(0,i.jsx)(n.td,{children:'System-caused problem preventing correct results for requests. Major, "wake up a human" events.'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Warn"}),(0,i.jsx)(n.td,{children:"Something's wrong, like no caching, but can still correctly respond to requests. A human should investigate."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Info"}),(0,i.jsx)(n.td,{children:'Working as expected. Information needed for monitoring. Answers "Are things healthy."'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Debug"}),(0,i.jsx)(n.td,{children:"High-level data flow and errors. Rich insight, but not overwhelming. Per-request errors, but not happy-path."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Trace"}),(0,i.jsx)(n.td,{children:"Most verbose. Full data flow. Not intended to be used in production, or very rarely."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"log-levels",children:"Log Levels"}),"\n",(0,i.jsx)(n.p,{children:"To be able to balance the trade off between logging more information and having better performance, Athena's logging\nframework allows controlling which log messages are processed using Log Levels. Here are some guidelines to help figure\nout what level a particular message should be logged at. By following these guidelines, logging will be handled\nconsistently across the Athena codebase."}),"\n",(0,i.jsx)(n.h3,{id:"error",children:"Error"}),"\n",(0,i.jsxs)(n.p,{children:["Should be used when Athena is having trouble and cannot reliably respond to requests. Under normal running conditions,\nthere shouldn't be ",(0,i.jsx)(n.code,{children:"Error"}),"-level logs emitted by Athena. Any ",(0,i.jsx)(n.code,{children:"Error"}),"-level logs that ",(0,i.jsx)(n.em,{children:"are"})," emitted by Athena should be\nmajor events that likely require urgent intervention. Here are some examples:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["There is a configuration error that will prevent the application from working ",(0,i.jsx)(n.em,{children:"correctly"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"There is an unexpected error (ie. not caused by the user) that is going to result in failing the request with a 500\nHTTP status code."}),"\n",(0,i.jsxs)(n.p,{children:["Expected request failure conditions that are ",(0,i.jsx)(n.em,{children:"not"})," the user's fault which result in 5xx-level HTTP\nstatus codes should ",(0,i.jsx)(n.em,{children:"not"})," result in a log at the ",(0,i.jsx)(n.code,{children:"Error"})," level. Examples of these include ",(0,i.jsx)(n.code,{children:"503 Service Unavailable"}),"\nresponses when some runtime data/objects hasn't been loaded, or ",(0,i.jsx)(n.code,{children:"507 Insufficient Storage"})," when a request exceeds the\nweight limit."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"warn",children:"Warn"}),"\n",(0,i.jsxs)(n.p,{children:["Should be used when something isn't right, but Athena can still reliably respond to requests. Under normal running\nconditions, there ",(0,i.jsx)(n.em,{children:"may"})," be ",(0,i.jsx)(n.code,{children:"Warn"}),"-level logs emitted by Athena. ",(0,i.jsx)(n.code,{children:"Warn"}),"-level logs that are emitted by Athena ",(0,i.jsx)(n.em,{children:"should"})," be\nlooked at by a human, but should not typically require urgent intervention. Here are some examples:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"There is a configuration error that will not prevent requests from being correctly satisfied, but requests may be\nsatisfied non-optimally or with some other down-side."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The app tries to start as indicated, but has to fall back to some default configuration because an error was\nencountered. The app can still start, but not the way it expected to."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"A non-critical service is unavailable or is having trouble. It's possible that the issue will correct itself, but that\ndepends on the service."}),"\n",(0,i.jsx)(n.p,{children:"For example, the Swift response cache might be having errors or timing out. This won't prevent Athena from correctly\nresponding to the request, but it may not be as fast due to the cache not working."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"info",children:"Info"}),"\n",(0,i.jsxs)(n.p,{children:["Should be used to indicate status and telemetry for each HTTP request processed, as well as non-recurring events and\ninformation about the state of Athena. It is expected that Athena will be running at the ",(0,i.jsx)(n.code,{children:"Info"}),' logging level when\nrunning in production. As such, the information logged at this level should be the information needed for monitoring\npurposes, meaning that it effectively answers "Is the application healthy?" and "How is the application being used?"']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Startup / shutdown information (success or failure of main components starting or stopping)"}),"\n",(0,i.jsx)(n.li,{children:"Timing and telemetry about processing each request"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"debug",children:"Debug"}),"\n",(0,i.jsxs)(n.p,{children:["Should be used to indicate high-level data flow and request handling steps. It's expected that the ",(0,i.jsx)(n.code,{children:"Debug"})," log level\nwill be used when determining why something is behaving unexpectedly. As such, the information logged at the ",(0,i.jsx)(n.code,{children:"Debug"}),"\nlevel should give a fairly rich insight into what is happening, but should not contain so much information as to be\noverwhelming."]}),"\n",(0,i.jsxs)(n.p,{children:['One exception to this is that "normal" or "',(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Happy_path",children:"happy path"}),'" request processing\nflow should ',(0,i.jsx)(n.em,{children:"not"})," be logged at the ",(0,i.jsx)(n.code,{children:"Debug"})," level. This is because it's assumed that the bulk of the work will be for\nprocessing requests and we don't want to flood the log with too many \"everything is working as normal\" events. Here are\nsome examples of what should be logged at the ",(0,i.jsx)(n.code,{children:"Debug"})," level:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"When the request is going to fail due to user error, like an improper date format or other input validation error."}),"\n",(0,i.jsx)(n.li,{children:"Once-per-request information, like which Swift Account/Container is selected."}),"\n",(0,i.jsx)(n.li,{children:"Normal execution flow while starting up / shutting down."}),"\n",(0,i.jsx)(n.li,{children:"Normal execution flow while running, but not processing a request."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"trace",children:"Trace"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Trace"}),' is the most verbose log level and it\'s expected that it will only be turned on very rarely in a production\nsetting. This is the level at which to log "normal" execution flow for request handling.']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Normal execution flow while processing a request."}),"\n",(0,i.jsx)(n.li,{children:"Large or tight loops for any kind of execution (app-start, non-request, request processing)."}),"\n",(0,i.jsx)(n.li,{children:"If the loop is time-sensitive or particularly hot, however, consider logging outside the loop so as not to impede\nperformance."}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);